<!doctype html><html lang=ru><head><meta charset=utf-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1" name=viewport><title>Сказ о том как я из QRов видео собирал</title><meta content="Кодерный понедельник" name=description><meta content=https://freecx.github.io/touch-icon.png property=og:image><link href=https://code.cdn.mozilla.net/fonts/fira.css rel=stylesheet><link href=https://freecx.github.io/favicon.png rel=icon><link href=https://freecx.github.io/touch-icon.png rel=apple-touch-icon><link href=https://freecx.github.io/main.css rel=stylesheet><link href=https://freecx.github.io/syntax.css rel=stylesheet><body><aside class=logo><a href=https://github.com/FreeCX> <img class=gravatar src=https://freecx.github.io/avatar.png> </a><span class=logo-prompt>Я на github</span></aside><article><div class=center><h1>Сказ о том как я из QRов видео собирал</h1><time>11 January 2021</time></div><div class=divider></div><p>Всем привет.<p>Эту небольшую заметку меня всподвигнул написать <a href=https://my-qr.art/>вот этот сайт</a> и @okdoc.<p>Если кратко, то можно запихнуть в qr код любую картинку.<p>Я же решил пойти дальше и сделать qr видео.<p>Об этом и будет мой рассказ.<h1 id=ideia>Идея</h1><p>Идея довольно проста:<ol><li>Получаем кадр из видео.<li>Режем под нужный размер.<li>Используем эффект дизеринга, чтобы получить двухцветную картинку.<li>Генерируем из картинки QR код.<li>Передаём QR код в рендер.<li>Переходим к 1, если есть ещё кадры.</ol><h1 id=pilim>Пилим</h1><p>Сначала я решил написать рендер и нарезжщик видео на картинки.<p>Если рендер я уже ранее <a href=https://freecx.github.io/blog/2020/07/23/2.5d-effect>реализовывал</a>, то с нарезщиком нужно было делать.<p>Давайте сразу к коду<pre class=language-python data-lang=python style=color:#111;background-color:#f9f9f9><code class=language-python data-lang=python><span style=color:#8959a8>import </span><span>subprocess </span><span style=color:#8959a8>as </span><span>sp
</span><span style=color:#8959a8>import </span><span>io
</span><span>
</span><span style=color:#8959a8>from </span><span>PIL </span><span style=color:#8959a8>import </span><span>Image
</span><span style=color:#8959a8>import </span><span>numpy </span><span style=color:#8959a8>as </span><span>np
</span><span>
</span><span>
</span><span style=color:#8e908c># Наше рендер
</span><span style=color:#8959a8>class </span><span style=color:#c99e00>Render</span><span>:
</span><span>    </span><span style=color:#8959a8>def </span><span style=color:#4271ae>__init__</span><span>(</span><span style=color:#f07219>self</span><span>, </span><span style=color:#f07219>fps</span><span>, </span><span style=color:#f07219>size</span><span>, </span><span style=color:#f07219>output</span><span>):
</span><span>        </span><span style=color:#c82728>self</span><span>.cmd_out </span><span style=color:#3e999f>= </span><span>[
</span><span>            </span><span style=color:#8e908c># будем использовать ffmpeg
</span><span>            </span><span style=color:#839c00>'ffmpeg'</span><span>,
</span><span>            </span><span style=color:#8e908c># нам не нужен банер ffmpeg в stdout
</span><span>            </span><span style=color:#839c00>'-hide_banner'</span><span>, 
</span><span>            </span><span style=color:#8e908c># будем использовать pipe с raw картинкой на 24 бита
</span><span>            </span><span style=color:#839c00>'-f'</span><span>, </span><span style=color:#839c00>'image2pipe'</span><span>, </span><span style=color:#839c00>'-pix_fmt'</span><span>, </span><span style=color:#839c00>'rgb24'</span><span>,
</span><span>            </span><span style=color:#8e908c># обязательно укажем fps видео
</span><span>            </span><span style=color:#839c00>'-r'</span><span>, </span><span style=color:#c99e00>str</span><span style=color:#4271ae>(fps)</span><span>,
</span><span>            </span><span style=color:#8e908c># и пайп
</span><span>            </span><span style=color:#839c00>'-i'</span><span>, </span><span style=color:#839c00>'-'</span><span>,
</span><span>            </span><span style=color:#8e908c># будем перемасщтабировать видео 
</span><span>            </span><span style=color:#839c00>'-vf'</span><span>, </span><span style=color:#8959a8>f</span><span style=color:#839c00>'scale=</span><span>{size[</span><span style=color:#f07219>0</span><span>]}</span><span style=color:#839c00>:</span><span>{size[</span><span style=color:#f07219>1</span><span>]}</span><span style=color:#839c00>'</span><span>,
</span><span>            </span><span style=color:#8e908c># с методом скейлинга по соседям
</span><span>            </span><span style=color:#839c00>'-sws_flags'</span><span>, </span><span style=color:#839c00>'neighbor'</span><span>,
</span><span>            </span><span style=color:#8e908c># и укажем выходной формат видео
</span><span>            </span><span style=color:#839c00>'-c:v'</span><span>, </span><span style=color:#839c00>'libx264'</span><span>, </span><span style=color:#839c00>'-pix_fmt'</span><span>, </span><span style=color:#839c00>'yuv420p'</span><span>,
</span><span>            </span><span style=color:#8e908c># перезапишем выходной файл
</span><span>            </span><span style=color:#839c00>'-y'</span><span>,
</span><span>            </span><span style=color:#8e908c># вот этот
</span><span>            </span><span style=color:#c99e00>str</span><span style=color:#4271ae>(output)
</span><span>        ]
</span><span>        </span><span style=color:#8e908c># нам нужен пайп куда будем писать данные
</span><span>        </span><span style=color:#c82728>self</span><span>.pipe </span><span style=color:#3e999f>= </span><span style=color:#4271ae>sp.</span><span style=color:#c82728>Popen</span><span style=color:#4271ae>(</span><span style=color:#c82728>self</span><span style=color:#4271ae>.cmd_out, </span><span style=color:#f07219>stdin</span><span style=color:#3e999f>=</span><span style=color:#4271ae>sp.</span><span style=color:#c82728>PIPE</span><span style=color:#4271ae>)
</span><span>
</span><span>    </span><span style=color:#8959a8>def </span><span style=color:#4271ae>push</span><span>(</span><span style=color:#f07219>self</span><span>, </span><span style=color:#f07219>qr</span><span>):
</span><span>        </span><span style=color:#8e908c># qr сразу в пайп
</span><span>        </span><span style=color:#4271ae>qr.</span><span style=color:#c82728>png</span><span style=color:#4271ae>(</span><span style=color:#c82728>self</span><span style=color:#4271ae>.pipe.stdin)
</span><span>
</span><span>    </span><span style=color:#8e908c># и закрытие пайпа при завершении работы
</span><span>    </span><span style=color:#8959a8>def </span><span style=color:#4271ae>__del__</span><span>(</span><span style=color:#f07219>self</span><span>):
</span><span>        </span><span style=color:#c82728>self</span><span style=color:#4271ae>.pipe.stdin.</span><span style=color:#c82728>close</span><span style=color:#4271ae>()
</span><span>        </span><span style=color:#c82728>self</span><span style=color:#4271ae>.pipe.</span><span style=color:#c82728>wait</span><span style=color:#4271ae>()
</span><span>
</span><span>        </span><span style=color:#8959a8>if </span><span style=color:#c82728>self</span><span>.pipe.returncode </span><span style=color:#3e999f>!= </span><span style=color:#f07219>0</span><span>:
</span><span>            </span><span style=color:#8959a8>raise </span><span style=color:#4271ae>sp.</span><span style=color:#c82728>CalledProcessError</span><span style=color:#4271ae>(</span><span style=color:#c82728>self</span><span style=color:#4271ae>.pipe.returncode, </span><span style=color:#c82728>self</span><span style=color:#4271ae>.cmd_out)
</span><span>
</span><span style=color:#8e908c># наш нарезщик
</span><span style=color:#8959a8>class </span><span style=color:#c99e00>Images</span><span>:
</span><span>    </span><span style=color:#8959a8>def </span><span style=color:#4271ae>__init__</span><span>(</span><span style=color:#f07219>self</span><span>, </span><span style=color:#f07219>size</span><span>, </span><span style=color:#f07219>input</span><span>):
</span><span>        </span><span style=color:#c82728>self</span><span>.cmd_out </span><span style=color:#3e999f>= </span><span>[
</span><span>            </span><span style=color:#8e908c># см. выше
</span><span>            </span><span style=color:#839c00>'ffmpeg'</span><span>,
</span><span>            </span><span style=color:#839c00>'-hide_banner'</span><span>,
</span><span>            </span><span style=color:#8e908c># будем выводить только ошибки
</span><span>            </span><span style=color:#839c00>'-loglevel'</span><span>, </span><span style=color:#839c00>'panic'</span><span>,
</span><span>            </span><span style=color:#8e908c># входное видео
</span><span>            </span><span style=color:#839c00>'-i'</span><span>, </span><span style=color:#4271ae>input</span><span>,
</span><span>            </span><span style=color:#8e908c># кропаем по высоте и уменьшаем размер картинки
</span><span>            </span><span style=color:#839c00>'-vf'</span><span>, </span><span style=color:#8959a8>f</span><span style=color:#839c00>'crop=in_h:in_h,scale=</span><span>{size}</span><span style=color:#839c00>:</span><span>{size}</span><span style=color:#839c00>'</span><span>,
</span><span>            </span><span style=color:#8e908c># выходной формат изображения в пайпе
</span><span>            </span><span style=color:#839c00>'-c:v'</span><span>, </span><span style=color:#839c00>'rawvideo'</span><span>, </span><span style=color:#839c00>'-f'</span><span>, </span><span style=color:#839c00>'image2pipe'</span><span>, </span><span style=color:#839c00>'-pix_fmt'</span><span>, </span><span style=color:#839c00>'rgb24'</span><span>, </span><span style=color:#839c00>'-'
</span><span>        ]
</span><span>        </span><span style=color:#c82728>self</span><span>.size </span><span style=color:#3e999f>= </span><span>(size, size)
</span><span>        </span><span style=color:#8e908c># обрати внимание что здесь stdout, т.к. мы читаем на не пишем
</span><span>        </span><span style=color:#c82728>self</span><span>.pipe </span><span style=color:#3e999f>= </span><span style=color:#4271ae>sp.</span><span style=color:#c82728>Popen</span><span style=color:#4271ae>(</span><span style=color:#c82728>self</span><span style=color:#4271ae>.cmd_out, </span><span style=color:#f07219>stdout</span><span style=color:#3e999f>=</span><span style=color:#4271ae>sp.</span><span style=color:#c82728>PIPE</span><span style=color:#4271ae>)
</span><span>
</span><span>    </span><span style=color:#8e908c># будем использовать итератор
</span><span>    </span><span style=color:#8959a8>def </span><span style=color:#4271ae>__iter__</span><span>(</span><span style=color:#f07219>self</span><span>):
</span><span>        </span><span style=color:#8959a8>return </span><span style=color:#c82728>self
</span><span>
</span><span>    </span><span style=color:#8959a8>def </span><span style=color:#4271ae>__next__</span><span>(</span><span style=color:#f07219>self</span><span>):
</span><span>        </span><span style=color:#8e908c># читаем сырой кадр
</span><span>        data </span><span style=color:#3e999f>= </span><span style=color:#c82728>self</span><span style=color:#4271ae>.pipe.stdout.</span><span style=color:#c82728>read</span><span style=color:#4271ae>(</span><span style=color:#c82728>self</span><span style=color:#4271ae>.size[</span><span style=color:#f07219>0</span><span style=color:#4271ae>] </span><span style=color:#3e999f>* </span><span style=color:#c82728>self</span><span style=color:#4271ae>.size[</span><span style=color:#f07219>1</span><span style=color:#4271ae>] </span><span style=color:#3e999f>* </span><span style=color:#f07219>3</span><span style=color:#4271ae>)
</span><span>        </span><span style=color:#8e908c># преобразуем в картинку
</span><span>        </span><span style=color:#8959a8>return </span><span style=color:#4271ae>Image.</span><span style=color:#c82728>frombuffer</span><span style=color:#4271ae>(</span><span style=color:#839c00>'RGB'</span><span style=color:#4271ae>, </span><span style=color:#c82728>self</span><span style=color:#4271ae>.size, data, </span><span style=color:#839c00>'raw'</span><span style=color:#4271ae>, </span><span style=color:#839c00>'RGB'</span><span style=color:#4271ae>, </span><span style=color:#f07219>0</span><span style=color:#4271ae>, </span><span style=color:#f07219>1</span><span style=color:#4271ae>)
</span><span>
</span><span>    </span><span style=color:#8e908c># см. выше
</span><span>    </span><span style=color:#8959a8>def </span><span style=color:#4271ae>__del__</span><span>(</span><span style=color:#f07219>self</span><span>):
</span><span>        </span><span style=color:#c82728>self</span><span style=color:#4271ae>.pipe.stdout.</span><span style=color:#c82728>close</span><span style=color:#4271ae>()
</span><span>        </span><span style=color:#c82728>self</span><span style=color:#4271ae>.pipe.</span><span style=color:#c82728>wait</span><span style=color:#4271ae>()
</span><span>
</span><span>        </span><span style=color:#8959a8>if </span><span style=color:#c82728>self</span><span>.pipe.returncode </span><span style=color:#3e999f>!= </span><span style=color:#f07219>0</span><span>:
</span><span>            </span><span style=color:#8959a8>raise </span><span style=color:#4271ae>sp.</span><span style=color:#c82728>CalledProcessError</span><span style=color:#4271ae>(</span><span style=color:#c82728>self</span><span style=color:#4271ae>.pipe.returncode, </span><span style=color:#c82728>self</span><span style=color:#4271ae>.cmd_out)
</span></code></pre><p>Теперь можно взять и подготовить готовую <a href=https://github.com/mnooner256/pyqrcode>библиотеку</a> и файлы <a href=https://github.com/raatmarien/my-qr.art/tree/main/qr_app>qrmap.py и tables.py</a>.<p>Собираем всё в папку и пишем главный файл<pre class=language-python data-lang=python style=color:#111;background-color:#f9f9f9><code class=language-python data-lang=python><span style=color:#8959a8>from </span><span>pathlib </span><span style=color:#8959a8>import </span><span>Path
</span><span style=color:#8959a8>from </span><span>PIL </span><span style=color:#8959a8>import </span><span>Image
</span><span style=color:#8959a8>import </span><span>numpy </span><span style=color:#8959a8>as </span><span>np
</span><span style=color:#8959a8>import </span><span>argparse
</span><span style=color:#8959a8>import </span><span>io
</span><span>
</span><span style=color:#8959a8>import </span><span>ffmpeg
</span><span style=color:#8959a8>import </span><span>qrmap
</span><span>
</span><span>
</span><span style=color:#8959a8>if </span><span>__name__ </span><span style=color:#3e999f>== </span><span style=color:#839c00>'__main__'</span><span>:
</span><span>    </span><span style=color:#8e908c># парсинг аргументов
</span><span>    parser </span><span style=color:#3e999f>= </span><span style=color:#4271ae>argparse.</span><span style=color:#c82728>ArgumentParser</span><span style=color:#4271ae>(</span><span style=color:#f07219>description</span><span style=color:#3e999f>=</span><span style=color:#839c00>'video as qrcode'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>parser.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-i'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'input'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'input'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>str</span><span style=color:#4271ae>, </span><span style=color:#f07219>required</span><span style=color:#3e999f>=</span><span style=color:#f07219>True</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'input video'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>parser.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-f'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'frame'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'frame'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>int</span><span style=color:#4271ae>, </span><span style=color:#f07219>default</span><span style=color:#3e999f>=</span><span style=color:#f07219>30</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'frames per second (default: 30)'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>parser.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-s'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'scale'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'scale'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>int</span><span style=color:#4271ae>, </span><span style=color:#f07219>default</span><span style=color:#3e999f>=</span><span style=color:#f07219>4</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'scale factor (default: 4)'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>parser.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-u'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'url'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'url'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>str</span><span style=color:#4271ae>, </span><span style=color:#f07219>default</span><span style=color:#3e999f>=</span><span style=color:#839c00>'some text'</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'qr code data'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>parser.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-q'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'qr_size'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'qr_size'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>int</span><span style=color:#4271ae>, </span><span style=color:#f07219>default</span><span style=color:#3e999f>=</span><span style=color:#f07219>177</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'qr size'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>parser.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-o'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'output'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'output'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>str</span><span style=color:#4271ae>, </span><span style=color:#f07219>default</span><span style=color:#3e999f>=</span><span style=color:#839c00>'render.mp4'</span><span style=color:#4271ae>,
</span><span style=color:#4271ae>        </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'output video file (default: render.mp4'</span><span style=color:#4271ae>)
</span><span>
</span><span>    args </span><span style=color:#3e999f>= </span><span style=color:#4271ae>parser.</span><span style=color:#c82728>parse_args</span><span style=color:#4271ae>()
</span><span>    </span><span style=color:#8959a8>if </span><span>args.scale </span><span style=color:#3e999f>< </span><span style=color:#f07219>1</span><span>:
</span><span>        </span><span style=color:#4271ae>print(</span><span style=color:#8959a8>f</span><span style=color:#839c00>'[error]: scale factor cannot be less than 1'</span><span style=color:#4271ae>)
</span><span>        </span><span style=color:#c82728>exit</span><span style=color:#4271ae>()
</span><span>
</span><span>    </span><span style=color:#8e908c># размер выходного видео
</span><span>    new_size </span><span style=color:#3e999f>= </span><span>(args.qr_size </span><span style=color:#3e999f>* </span><span>args.scale, args.qr_size </span><span style=color:#3e999f>* </span><span>args.scale)
</span><span>    </span><span style=color:#8e908c># инициализируем рендер
</span><span>    render </span><span style=color:#3e999f>= </span><span style=color:#4271ae>ffmpeg.</span><span style=color:#c82728>Render</span><span style=color:#4271ae>(</span><span style=color:#f07219>fps</span><span style=color:#3e999f>=</span><span style=color:#4271ae>args.frame, </span><span style=color:#f07219>size</span><span style=color:#3e999f>=</span><span style=color:#4271ae>new_size, </span><span style=color:#f07219>output</span><span style=color:#3e999f>=</span><span style=color:#4271ae>args.output)
</span><span>    </span><span style=color:#8e908c># и итерируемся по кадрам входного видео
</span><span>    </span><span style=color:#8959a8>for </span><span>index, frame </span><span style=color:#8959a8>in </span><span style=color:#4271ae>enumerate(ffmpeg.</span><span style=color:#c82728>Images</span><span style=color:#4271ae>(</span><span style=color:#f07219>input</span><span style=color:#3e999f>=</span><span style=color:#4271ae>args.input, </span><span style=color:#f07219>size</span><span style=color:#3e999f>=</span><span style=color:#4271ae>args.qr_size))</span><span>:
</span><span>        </span><span style=color:#8e908c># применяем дизеринг ('1') и преобразуем в палитру в градации серого ('L'),
</span><span>        </span><span style=color:#8e908c># а также поворачиваем картинку из-за массивов numpy
</span><span>        frame </span><span style=color:#3e999f>= </span><span style=color:#4271ae>frame.</span><span style=color:#c82728>convert</span><span style=color:#4271ae>(</span><span style=color:#839c00>'1'</span><span style=color:#4271ae>).</span><span style=color:#c82728>convert</span><span style=color:#4271ae>(</span><span style=color:#839c00>'L'</span><span style=color:#4271ae>).</span><span style=color:#c82728>rotate</span><span style=color:#4271ae>(</span><span style=color:#f07219>90</span><span style=color:#4271ae>)
</span><span>        </span><span style=color:#8e908c># преобразуем массив в нужный вид
</span><span>        data </span><span style=color:#3e999f>= </span><span style=color:#4271ae>np.</span><span style=color:#c82728>array</span><span style=color:#4271ae>(frame).</span><span style=color:#c82728>reshape</span><span style=color:#4271ae>((frame.size[</span><span style=color:#f07219>1</span><span style=color:#4271ae>], frame.size[</span><span style=color:#f07219>0</span><span style=color:#4271ae>], </span><span style=color:#f07219>1</span><span style=color:#4271ae>))
</span><span>        </span><span style=color:#8e908c># генеруем QR код
</span><span>        design </span><span style=color:#3e999f>= </span><span style=color:#4271ae>qrmap.QrMap.</span><span style=color:#c82728>from_array</span><span style=color:#4271ae>(data)
</span><span>        qr </span><span style=color:#3e999f>= </span><span style=color:#4271ae>qrmap.</span><span style=color:#c82728>create_qr_from_map</span><span style=color:#4271ae>(design, args.url, </span><span style=color:#839c00>'binary'</span><span style=color:#4271ae>, </span><span style=color:#839c00>'L'</span><span style=color:#4271ae>)
</span><span>        </span><span style=color:#8e908c># и отправляем его в рендер
</span><span>        </span><span style=color:#4271ae>render.</span><span style=color:#c82728>push</span><span style=color:#4271ae>(qr)
</span><span>        </span><span style=color:#4271ae>print(</span><span style=color:#8959a8>f</span><span style=color:#839c00>'</span><span style=color:#f07219>\r</span><span style=color:#839c00>frame </span><span style=color:#4271ae>{index}</span><span style=color:#839c00>'</span><span style=color:#4271ae>, </span><span style=color:#f07219>end</span><span style=color:#3e999f>=</span><span style=color:#839c00>''</span><span style=color:#4271ae>)
</span></code></pre><h1 id=zakliuchenie>Заключение</h1><p>Результат работы (с добавленной звуковой дорожкой) можно посмотреть <a href=https://t.me/aomadhfianais/1988>здесь</a>, а архив со всем проектом доступен <a href=https://drive.google.com/file/d/1NtZbUpg0ZZlH5hXNF1DPIYicrOFHeH4Y>здесь</a>.<p>А на этом пока всё, всем пока!<h1 id=chto-pochitat>Что почитать</h1><ol><li><a href=https://my-qr.art/>На чём основана работа</a></ol></article><div class=back><a href=https://freecx.github.io/>Назад</a></div><div class=footer><span>Также читайте <a title="ты сам сломал ссылку, так что ничего личного" href=https://antoniii.github.io/> <s>antoniii</s> </a> <a href=https://citrux.github.io/>citrux</a> <a href=https://sputnikas.github.io/>sputnikas</a> </span></div><script>let msg=` А спонсор статей в моём блоге -- моя лень -- спонсор статей.`;[`=`.repeat(msg.length+ 1),msg,`=`.repeat(msg.length+ 1)].forEach(a=>console.warn(a))</script>