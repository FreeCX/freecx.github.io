<!doctype html><html lang=ru><head><meta charset=utf-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1" name=viewport><title>Коробка для паролей</title><meta content="Кодерный понедельник" name=description><meta content=https://freecx.github.io/touch-icon.png property=og:image><link href=https://code.cdn.mozilla.net/fonts/fira.css rel=stylesheet><link href=https://freecx.github.io/favicon.png rel=icon><link href=https://freecx.github.io/touch-icon.png rel=apple-touch-icon><link href=https://freecx.github.io/main.css rel=stylesheet><link href=https://freecx.github.io/syntax.css rel=stylesheet><body><aside class=logo><a href=https://github.com/FreeCX> <img class=gravatar src=https://freecx.github.io/avatar.png> </a><span class=logo-prompt>Я на github</span></aside><article><div class=center><h1>Коробка для паролей</h1><time>13 January 2021</time></div><div class=divider></div><p>Всем привет.<p>Сегодня я немного расскажу про интересный способ хранения паролей.<p>Сразу внесу ясность:<blockquote><p>я не специалист и этот метод скорее всего не очень хорош по сравнению с <a href=https://keepassxc.org/>KeePass</a> или аналогичными программам</blockquote><p>Так что это просто <em>proof of concept</em>, я вас предупредил!<p>Погнали!<h1 id=ideia>Идея</h1><p>Идея метода хранения паролей мне пришла довольно недавно и составит в следующем:<blockquote><p>а что если сгенерировать некий файл со псевдослучайными символами в нём, а потом по некоторому алгоритму заменить символы на парольные</blockquote><p>Сразу возникают вопросы:<ol><li>Какой алфавит выбрать для создания файла?<li>Каким методом заполнять файл чтобы данные были в нём довольно случайными?<li>По какому алгоритму записывать пароль в этот файл, чтобы не в открытую он там был?</ol><p>По первому пункту можно сразу легко всё решить - для большей стойкости используй весь диапазон [0, 255], но я для упрощения возьму только печатные символы.<p>По второму пункту не будем сильно мучиться и используем стандартную библиотеку <a href=https://docs.python.org/3/library/secrets.html>secrets</a>, а конкретнее нам понадобится функция <a href=https://docs.python.org/3/library/secrets.html#secrets.choice>choice</a>.<p>На третьем пункте остановимся по подробнее.<h1 id=tretii-punkt>Третий пункт</h1><p>У нас есть некоторый файл с ограниченной длиной и нам нужно в нём спрятать пароль.<p>Как же это сделать, чтобы пароль не лежал в открытую?<p>Самое простое решение - записать в случайные места в файле!<p>Но чтобы считать этот пароль обратно нам нужно как-то повторить это действие в обратную и получить эти символы!<p>На помощь нам приходит такая классная штука как <em>seed</em>.<p>Из-за того что истинно случайные числа не так просто получить, то были придуманы алгоритмы которые дают последовательно псевдослучайных числе с большим периодом после которого эта последовательность начинает повторяться. В нашем случае пароли будут не очень большими и поэтому можно вообще забыть про эту особенность.<p>А при чём тут <em>seed</em> тогда?<p>Для того чтобы последовательность была каждый раз разная и задают <em>seed</em>, т.е. отправное значение в алгоритме генерации.<p>Раньше часто использовали текущее время в системе, чтобы задать значение <em>seed</em>, но сейчас лучше вообще использовать более криптостойкие методы, т.к. стандартный random почти в любом языке годен только для простых вещей.<p>Но нам для реализации вполне хватит стандартной библиотеки <a href="https://docs.python.org/3/library/random.html?highlight=random#module-random">random</a>.<h1 id=realizatsiia>Реализация</h1><p>Сразу в код без лишней болтовни<pre class=language-python data-lang=python style=color:#111;background-color:#f9f9f9><code class=language-python data-lang=python><span style=color:#8959a8>from </span><span>pathlib </span><span style=color:#8959a8>import </span><span>Path
</span><span style=color:#8959a8>import </span><span>argparse
</span><span style=color:#8959a8>import </span><span>secrets
</span><span style=color:#8959a8>import </span><span>random
</span><span style=color:#8959a8>import </span><span>string
</span><span>
</span><span>
</span><span style=color:#8959a8>def </span><span style=color:#4271ae>generate</span><span>(</span><span style=color:#f07219>args</span><span>):
</span><span>    </span><span style=color:#8e908c>"""Функция генерации данных для 'коробки'.
</span><span style=color:#8e908c>
</span><span style=color:#8e908c>    Входные параметры:
</span><span style=color:#8e908c>    args.alphabet   -- используемый алфавит
</span><span style=color:#8e908c>    args.length     -- длина файла в символах
</span><span style=color:#8e908c>    args.box        -- выходной файл
</span><span style=color:#8e908c>    """
</span><span>    </span><span style=color:#8959a8>with </span><span style=color:#4271ae>args.box.</span><span style=color:#c82728>open</span><span style=color:#4271ae>(</span><span style=color:#839c00>'w'</span><span style=color:#4271ae>) </span><span style=color:#8959a8>as </span><span>f:
</span><span>        </span><span style=color:#8e908c># генерируем последовательность по заданному алфавиту длиной args.length
</span><span>        box </span><span style=color:#3e999f>= </span><span>[</span><span style=color:#4271ae>secrets.</span><span style=color:#c82728>choice</span><span style=color:#4271ae>(args.alphabet) </span><span style=color:#8959a8>for </span><span style=color:#c82728>_ </span><span style=color:#8959a8>in </span><span style=color:#4271ae>range(args.length)</span><span>]
</span><span>        </span><span style=color:#8e908c># и пишем в 'коробку'
</span><span>        </span><span style=color:#4271ae>f.</span><span style=color:#c82728>write</span><span style=color:#4271ae>(</span><span style=color:#839c00>''</span><span style=color:#4271ae>.</span><span style=color:#c82728>join</span><span style=color:#4271ae>(box))
</span><span>        </span><span style=color:#4271ae>print(</span><span style=color:#8959a8>f</span><span style=color:#839c00>'> Box `</span><span style=color:#4271ae>{args.box.name}</span><span style=color:#839c00>` created'</span><span style=color:#4271ae>)
</span><span>
</span><span>
</span><span style=color:#8959a8>def </span><span style=color:#4271ae>read</span><span>(</span><span style=color:#f07219>args</span><span>):
</span><span>    </span><span style=color:#8e908c>"""Функция чтения пароля из 'коробки'.
</span><span style=color:#8e908c>
</span><span style=color:#8e908c>    Входные параметры:
</span><span style=color:#8e908c>    args.box    -- входной файл
</span><span style=color:#8e908c>    args.seed   -- зерно для функции random.seed
</span><span style=color:#8e908c>    args.length -- длина пароля
</span><span style=color:#8e908c>    """
</span><span>    </span><span style=color:#8e908c># считаем всю 'коробку' в переменную
</span><span>    alphabet </span><span style=color:#3e999f>= </span><span style=color:#4271ae>args.box.</span><span style=color:#c82728>open</span><span style=color:#4271ae>().</span><span style=color:#c82728>read</span><span style=color:#4271ae>()
</span><span>    </span><span style=color:#8e908c># установим начальное значение для генератора
</span><span>    </span><span style=color:#4271ae>random.</span><span style=color:#c82728>seed</span><span style=color:#4271ae>(args.seed)
</span><span>    </span><span style=color:#8e908c># вытащим последовательность символов из коробки
</span><span>    </span><span style=color:#4271ae>print(</span><span style=color:#839c00>''</span><span style=color:#4271ae>.</span><span style=color:#c82728>join</span><span style=color:#4271ae>(random.</span><span style=color:#c82728>choices</span><span style=color:#4271ae>(alphabet, </span><span style=color:#f07219>k</span><span style=color:#3e999f>=</span><span style=color:#4271ae>args.length)))
</span><span>
</span><span>
</span><span style=color:#8959a8>def </span><span style=color:#4271ae>insert</span><span>(</span><span style=color:#f07219>args</span><span>):
</span><span>    </span><span style=color:#8e908c>"""Функия добавления пароля в 'коробку'.
</span><span style=color:#8e908c>
</span><span style=color:#8e908c>    Входные параметры:
</span><span style=color:#8e908c>    args.box        -- входной файл
</span><span style=color:#8e908c>    args.seed       -- зерно для функции random.seed
</span><span style=color:#8e908c>    args.password   -- пароль для записи
</span><span style=color:#8e908c>    args.reseed     -- автоматическая генерация нового seed
</span><span style=color:#8e908c>    args.max_seed   -- максимальное число для генерации seed
</span><span style=color:#8e908c>    """
</span><span>    </span><span style=color:#8e908c># функция записи пароля в коробку
</span><span>    </span><span style=color:#8959a8>def </span><span style=color:#4271ae>rewrite_box</span><span>(</span><span style=color:#f07219>file</span><span>, </span><span style=color:#f07219>box</span><span>, </span><span style=color:#f07219>key</span><span>, </span><span style=color:#f07219>positions</span><span>):
</span><span>        </span><span style=color:#8e908c># просто пишем по сгенерированным индексам
</span><span>        </span><span style=color:#8959a8>for </span><span>key, index </span><span style=color:#8959a8>in </span><span style=color:#4271ae>zip(key, positions)</span><span>:
</span><span>            box[index] </span><span style=color:#3e999f>= </span><span>key
</span><span>        </span><span style=color:#8e908c># и запись в файл
</span><span>        </span><span style=color:#8959a8>with </span><span style=color:#4271ae>file.</span><span style=color:#c82728>open</span><span style=color:#4271ae>(</span><span style=color:#839c00>'w'</span><span style=color:#4271ae>) </span><span style=color:#8959a8>as </span><span>f:
</span><span>            </span><span style=color:#4271ae>f.</span><span style=color:#c82728>write</span><span style=color:#4271ae>(</span><span style=color:#839c00>''</span><span style=color:#4271ae>.</span><span style=color:#c82728>join</span><span style=color:#4271ae>(box))
</span><span>            </span><span style=color:#4271ae>print(</span><span style=color:#8959a8>f</span><span style=color:#839c00>'> Box `</span><span style=color:#4271ae>{args.box.name}</span><span style=color:#839c00>` updated'</span><span style=color:#4271ae>)
</span><span>
</span><span>    </span><span style=color:#8e908c># функция генерации индексов по входным значениям
</span><span>    </span><span style=color:#8959a8>def </span><span style=color:#4271ae>pos</span><span>(</span><span style=color:#f07219>seed</span><span>, </span><span style=color:#f07219>box_size</span><span>, </span><span style=color:#f07219>key_size</span><span>):
</span><span>        </span><span style=color:#4271ae>random.</span><span style=color:#c82728>seed</span><span style=color:#4271ae>(seed)
</span><span>        </span><span style=color:#8e908c># индексы всех элементов коробки
</span><span>        box_iter </span><span style=color:#3e999f>= </span><span style=color:#4271ae>range(box_size)
</span><span>        </span><span style=color:#8e908c># по сути длина ключа
</span><span>        key_iter </span><span style=color:#3e999f>= </span><span style=color:#4271ae>range(key_size)
</span><span>        </span><span style=color:#8e908c># выбираем K псевдослучайных индексов из коробки
</span><span>        </span><span style=color:#8959a8>return </span><span>[</span><span style=color:#4271ae>random.</span><span style=color:#c82728>choices</span><span style=color:#4271ae>(box_iter)</span><span>[</span><span style=color:#f07219>0</span><span>] </span><span style=color:#8959a8>for </span><span style=color:#c82728>_ </span><span style=color:#8959a8>in </span><span>key_iter]
</span><span>
</span><span>    </span><span style=color:#8e908c># нам нужны уникальные индексы без самопересечений
</span><span>    </span><span style=color:#8959a8>def </span><span style=color:#4271ae>unique</span><span>(</span><span style=color:#f07219>data</span><span>):
</span><span>        </span><span style=color:#8959a8>return </span><span style=color:#4271ae>len(data) </span><span style=color:#3e999f>== </span><span style=color:#4271ae>len(</span><span style=color:#c99e00>set</span><span style=color:#4271ae>(data))
</span><span>
</span><span>    </span><span style=color:#8e908c># считаем все элементы коробки в переменную
</span><span>    box </span><span style=color:#3e999f>= </span><span style=color:#c99e00>list</span><span style=color:#4271ae>(args.box.</span><span style=color:#c82728>open</span><span style=color:#4271ae>().</span><span style=color:#c82728>read</span><span style=color:#4271ae>())
</span><span>    </span><span style=color:#8959a8>if </span><span style=color:#4271ae>len(box) </span><span style=color:#3e999f>== </span><span style=color:#f07219>0</span><span>:
</span><span>        </span><span style=color:#4271ae>print(</span><span style=color:#839c00>'> Box is empty'</span><span style=color:#4271ae>)
</span><span>        </span><span style=color:#8959a8>return
</span><span>
</span><span>    </span><span style=color:#8e908c># сгенерируем индексы
</span><span>    positions </span><span style=color:#3e999f>= </span><span style=color:#c82728>pos</span><span style=color:#4271ae>(args.seed, len(box), len(args.password))
</span><span>
</span><span>    </span><span style=color:#8e908c># и проверим на самопересечение
</span><span>    </span><span style=color:#8959a8>if </span><span style=color:#c82728>unique</span><span style=color:#4271ae>(positions)</span><span>:
</span><span>        </span><span style=color:#c82728>rewrite_box</span><span style=color:#4271ae>(args.box, box, args.password, positions)
</span><span>    </span><span style=color:#8959a8>elif </span><span>args.reseed:
</span><span>        </span><span style=color:#8e908c># если включено автоматическая генерация нового seed
</span><span>        nseed_counter </span><span style=color:#3e999f>= </span><span style=color:#f07219>0
</span><span>        </span><span style=color:#8e908c># то будем перебирать
</span><span>        </span><span style=color:#8959a8>while </span><span style=color:#3e999f>not </span><span style=color:#c82728>unique</span><span style=color:#4271ae>(positions)</span><span>:
</span><span>            new_seed </span><span style=color:#3e999f>= </span><span style=color:#4271ae>secrets.</span><span style=color:#c82728>randbelow</span><span style=color:#4271ae>(args.max_seed)
</span><span>            positions </span><span style=color:#3e999f>= </span><span style=color:#c82728>pos</span><span style=color:#4271ae>(new_seed, len(box), len(args.password))
</span><span>            nseed_counter </span><span style=color:#3e999f>+= </span><span style=color:#f07219>1
</span><span>            </span><span style=color:#8959a8>if </span><span>nseed_counter </span><span style=color:#3e999f>> </span><span>args.max_seed:
</span><span>                </span><span style=color:#4271ae>print(</span><span style=color:#839c00>'> The number of attempts to generate new seed has been exceeded, please select a higher value max_seed'</span><span style=color:#4271ae>)
</span><span>                </span><span style=color:#8959a8>return
</span><span>        </span><span style=color:#4271ae>print(</span><span style=color:#839c00>'> New seed: </span><span>{new_seed}</span><span style=color:#839c00>'</span><span style=color:#4271ae>)
</span><span>        </span><span style=color:#8e908c># а потом запишем в файл
</span><span>        </span><span style=color:#c82728>rewrite_box</span><span style=color:#4271ae>(args.box, box, args.password, positions)
</span><span>    </span><span style=color:#8959a8>else</span><span>:
</span><span>        </span><span style=color:#4271ae>print(</span><span style=color:#839c00>'> An intersection has occurred, please choose new seed value or use -r'</span><span style=color:#4271ae>)
</span><span>
</span><span>
</span><span style=color:#8959a8>def </span><span style=color:#4271ae>analyze</span><span>(</span><span style=color:#f07219>args</span><span>):
</span><span>    </span><span style=color:#8e908c>"""Функция построения графика энтропии файла.
</span><span style=color:#8e908c>
</span><span style=color:#8e908c>    Входные параметры:
</span><span style=color:#8e908c>    args.box    -- входной файл для анализа
</span><span style=color:#8e908c>    args.save   -- выходное файл для сохранения графика
</span><span style=color:#8e908c>    """
</span><span>    </span><span style=color:#8959a8>from </span><span>collections </span><span style=color:#8959a8>import </span><span>Counter
</span><span>    </span><span style=color:#8959a8>import </span><span>matplotlib.pyplot </span><span style=color:#8959a8>as </span><span>plt
</span><span>
</span><span>    </span><span style=color:#8e908c># просто строим распределение символов в файле
</span><span>    data </span><span style=color:#3e999f>= </span><span style=color:#4271ae>args.box.</span><span style=color:#c82728>open</span><span style=color:#4271ae>().</span><span style=color:#c82728>read</span><span style=color:#4271ae>()
</span><span>    box </span><span style=color:#3e999f>= </span><span style=color:#c99e00>dict</span><span style=color:#4271ae>(</span><span style=color:#c82728>Counter</span><span style=color:#4271ae>(data))
</span><span>    xs </span><span style=color:#3e999f>= </span><span style=color:#c99e00>list</span><span style=color:#4271ae>(range(</span><span style=color:#f07219>256</span><span style=color:#4271ae>))
</span><span>    total </span><span style=color:#3e999f>= </span><span style=color:#4271ae>len(data)
</span><span>    ys </span><span style=color:#3e999f>= </span><span>[</span><span style=color:#4271ae>box.</span><span style=color:#c82728>get</span><span style=color:#4271ae>(chr(i), </span><span style=color:#f07219>0</span><span style=color:#4271ae>) </span><span style=color:#3e999f>/ </span><span>total </span><span style=color:#8959a8>for </span><span>i </span><span style=color:#8959a8>in </span><span>xs]
</span><span>
</span><span>    </span><span style=color:#4271ae>plt.</span><span style=color:#c82728>bar</span><span style=color:#4271ae>(xs, ys)
</span><span>    </span><span style=color:#4271ae>plt.</span><span style=color:#c82728>title</span><span style=color:#4271ae>(</span><span style=color:#839c00>'File entropy'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>plt.</span><span style=color:#c82728>xlabel</span><span style=color:#4271ae>(</span><span style=color:#839c00>'Alphabet, [0, 255]'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>plt.</span><span style=color:#c82728>ylabel</span><span style=color:#4271ae>(</span><span style=color:#839c00>'Percent count, %'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>plt.</span><span style=color:#c82728>grid</span><span style=color:#4271ae>(</span><span style=color:#f07219>alpha</span><span style=color:#3e999f>=</span><span style=color:#f07219>0.5</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#8959a8>if </span><span>args.save:
</span><span>        </span><span style=color:#4271ae>plt.</span><span style=color:#c82728>savefig</span><span style=color:#4271ae>(args.save, </span><span style=color:#f07219>bbox_inches</span><span style=color:#3e999f>=</span><span style=color:#839c00>'tight'</span><span style=color:#4271ae>, </span><span style=color:#f07219>pad_inches</span><span style=color:#3e999f>=</span><span style=color:#f07219>0.1</span><span style=color:#4271ae>, </span><span style=color:#f07219>dpi</span><span style=color:#3e999f>=</span><span style=color:#f07219>300</span><span style=color:#4271ae>)
</span><span>        </span><span style=color:#4271ae>print(</span><span style=color:#8959a8>f</span><span style=color:#839c00>'> Plot `</span><span style=color:#4271ae>{args.save}</span><span style=color:#839c00>` saved'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#8959a8>else</span><span>:
</span><span>        </span><span style=color:#4271ae>plt.</span><span style=color:#c82728>show</span><span style=color:#4271ae>()
</span><span>
</span><span>
</span><span style=color:#8959a8>if </span><span>__name__ </span><span style=color:#3e999f>== </span><span style=color:#839c00>'__main__'</span><span>:
</span><span>    </span><span style=color:#8e908c># задаём наш алфавит
</span><span>    alphabet </span><span style=color:#3e999f>= </span><span>string.ascii_letters </span><span style=color:#3e999f>+ </span><span>string.digits </span><span style=color:#3e999f>+ </span><span>string.punctuation
</span><span>
</span><span>    </span><span style=color:#8e908c># парсинг входных аргументов (читай доки по argparse)
</span><span>    parser </span><span style=color:#3e999f>= </span><span style=color:#4271ae>argparse.</span><span style=color:#c82728>ArgumentParser</span><span style=color:#4271ae>(</span><span style=color:#f07219>description</span><span style=color:#3e999f>=</span><span style=color:#839c00>'get your password from the box'</span><span style=color:#4271ae>)
</span><span>    subparser </span><span style=color:#3e999f>= </span><span style=color:#4271ae>parser.</span><span style=color:#c82728>add_subparsers</span><span style=color:#4271ae>()
</span><span>
</span><span>    p_read </span><span style=color:#3e999f>= </span><span style=color:#4271ae>subparser.</span><span style=color:#c82728>add_parser</span><span style=color:#4271ae>(</span><span style=color:#839c00>'read'</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'read password from the box'</span><span style=color:#4271ae>, </span><span style=color:#f07219>aliases</span><span style=color:#3e999f>=</span><span style=color:#4271ae>[</span><span style=color:#839c00>'r'</span><span style=color:#4271ae>])
</span><span>    </span><span style=color:#4271ae>p_read.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-b'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'box'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#4271ae>Path, </span><span style=color:#f07219>required</span><span style=color:#3e999f>=</span><span style=color:#f07219>True</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'input box file'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_read.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-s'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'seed'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'seed'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>int</span><span style=color:#4271ae>, </span><span style=color:#f07219>required</span><span style=color:#3e999f>=</span><span style=color:#f07219>True</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'initial seed value'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_read.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-l'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'length'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'length'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>int</span><span style=color:#4271ae>, </span><span style=color:#f07219>default</span><span style=color:#3e999f>=</span><span style=color:#f07219>16</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'password length'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_read.</span><span style=color:#c82728>set_defaults</span><span style=color:#4271ae>(</span><span style=color:#f07219>func</span><span style=color:#3e999f>=</span><span style=color:#4271ae>read)
</span><span>
</span><span>    p_create </span><span style=color:#3e999f>= </span><span style=color:#4271ae>subparser.</span><span style=color:#c82728>add_parser</span><span style=color:#4271ae>(</span><span style=color:#839c00>'generate'</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'generate password box'</span><span style=color:#4271ae>, </span><span style=color:#f07219>aliases</span><span style=color:#3e999f>=</span><span style=color:#4271ae>[</span><span style=color:#839c00>'g'</span><span style=color:#4271ae>, </span><span style=color:#839c00>'gen'</span><span style=color:#4271ae>])
</span><span>    </span><span style=color:#4271ae>p_create.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-b'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'box'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'box'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#4271ae>Path, </span><span style=color:#f07219>required</span><span style=color:#3e999f>=</span><span style=color:#f07219>True</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'input box file'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_create.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-l'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'length'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'length'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>int</span><span style=color:#4271ae>, </span><span style=color:#f07219>required</span><span style=color:#3e999f>=</span><span style=color:#f07219>True</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'box length'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_create.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-a'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'alphabet'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'alphabet'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>str</span><span style=color:#4271ae>, </span><span style=color:#f07219>default</span><span style=color:#3e999f>=</span><span style=color:#4271ae>alphabet,
</span><span style=color:#4271ae>                          </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'using alphabet'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_create.</span><span style=color:#c82728>set_defaults</span><span style=color:#4271ae>(</span><span style=color:#f07219>func</span><span style=color:#3e999f>=</span><span style=color:#4271ae>generate)
</span><span>
</span><span>    p_insert </span><span style=color:#3e999f>= </span><span style=color:#4271ae>subparser.</span><span style=color:#c82728>add_parser</span><span style=color:#4271ae>(</span><span style=color:#839c00>'insert'</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'insert password to the box'</span><span style=color:#4271ae>, </span><span style=color:#f07219>aliases</span><span style=color:#3e999f>=</span><span style=color:#4271ae>[</span><span style=color:#839c00>'i'</span><span style=color:#4271ae>, </span><span style=color:#839c00>'in'</span><span style=color:#4271ae>])
</span><span>    </span><span style=color:#4271ae>p_insert.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-b'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'box'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'box'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#4271ae>Path, </span><span style=color:#f07219>required</span><span style=color:#3e999f>=</span><span style=color:#f07219>True</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'input box file'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_insert.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-s'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'seed'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'seed'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>int</span><span style=color:#4271ae>, </span><span style=color:#f07219>required</span><span style=color:#3e999f>=</span><span style=color:#f07219>True</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'seed value'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_insert.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-p'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'password'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'password'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>str</span><span style=color:#4271ae>, </span><span style=color:#f07219>required</span><span style=color:#3e999f>=</span><span style=color:#f07219>True</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'password to insert'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_insert.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-r'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'reseed'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'reseed'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>bool</span><span style=color:#4271ae>, </span><span style=color:#f07219>default</span><span style=color:#3e999f>=</span><span style=color:#f07219>False</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'autogenerate new seed'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_insert.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-m'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'max_seed'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'max_seed'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#c99e00>int</span><span style=color:#4271ae>, </span><span style=color:#f07219>default</span><span style=color:#3e999f>=</span><span style=color:#f07219>1024</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'max seed value in reseed'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_insert.</span><span style=color:#c82728>set_defaults</span><span style=color:#4271ae>(</span><span style=color:#f07219>func</span><span style=color:#3e999f>=</span><span style=color:#4271ae>insert)
</span><span>
</span><span>    p_analyze </span><span style=color:#3e999f>= </span><span style=color:#4271ae>subparser.</span><span style=color:#c82728>add_parser</span><span style=color:#4271ae>(</span><span style=color:#839c00>'analyze'</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'analyze file entropy'</span><span style=color:#4271ae>, </span><span style=color:#f07219>aliases</span><span style=color:#3e999f>=</span><span style=color:#4271ae>[</span><span style=color:#839c00>'a'</span><span style=color:#4271ae>])
</span><span>    </span><span style=color:#4271ae>p_analyze.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-b'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'box'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'box'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#4271ae>Path, </span><span style=color:#f07219>required</span><span style=color:#3e999f>=</span><span style=color:#f07219>True</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'input box file'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_analyze.</span><span style=color:#c82728>add_argument</span><span style=color:#4271ae>(</span><span style=color:#839c00>'-s'</span><span style=color:#4271ae>, </span><span style=color:#f07219>dest</span><span style=color:#3e999f>=</span><span style=color:#839c00>'save'</span><span style=color:#4271ae>, </span><span style=color:#f07219>metavar</span><span style=color:#3e999f>=</span><span style=color:#839c00>'save'</span><span style=color:#4271ae>, </span><span style=color:#f07219>type</span><span style=color:#3e999f>=</span><span style=color:#4271ae>Path, </span><span style=color:#f07219>default</span><span style=color:#3e999f>=</span><span style=color:#f07219>None</span><span style=color:#4271ae>, </span><span style=color:#f07219>help</span><span style=color:#3e999f>=</span><span style=color:#839c00>'output plot file'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#4271ae>p_analyze.</span><span style=color:#c82728>set_defaults</span><span style=color:#4271ae>(</span><span style=color:#f07219>func</span><span style=color:#3e999f>=</span><span style=color:#4271ae>analyze)
</span><span>
</span><span>    args </span><span style=color:#3e999f>= </span><span style=color:#4271ae>parser.</span><span style=color:#c82728>parse_args</span><span style=color:#4271ae>()
</span><span>    </span><span style=color:#8959a8>if </span><span style=color:#4271ae>hasattr(args, </span><span style=color:#839c00>'func'</span><span style=color:#4271ae>)</span><span>:
</span><span>        </span><span style=color:#8959a8>try</span><span>:
</span><span>            </span><span style=color:#4271ae>args.</span><span style=color:#c82728>func</span><span style=color:#4271ae>(args)
</span><span>        </span><span style=color:#8959a8>except </span><span style=color:#c99e00>FileNotFoundError</span><span>:
</span><span>            </span><span style=color:#4271ae>print(</span><span style=color:#8959a8>f</span><span style=color:#839c00>'> File `</span><span style=color:#4271ae>{args.box}</span><span style=color:#839c00>` not found'</span><span style=color:#4271ae>)
</span><span>    </span><span style=color:#8959a8>else</span><span>:
</span><span>        </span><span style=color:#4271ae>parser.</span><span style=color:#c82728>print_help</span><span style=color:#4271ae>()
</span></code></pre><h1 id=zakliuchenie>Заключение</h1><p>Как вы могли понять из кода - важно помнить <em>seed</em> который вы используете для восстановления пароля.<p>Исходники утилиты можно найти <a href=https://github.com/FreeCX/bunch-of-code/blob/master/python/passwordbox.py>по ссылке</a>.<p>А на этом сегодня всё, всем пока!<h1 id=chto-pochitat>Что почитать</h1><ol><li>Я ничего не использовал, так что не будет ссылок</ol></article><div class=back><a href=https://freecx.github.io/>Назад</a></div><div class=footer><span>Также читайте <a title="ты сам сломал ссылку, так что ничего личного" href=https://antoniii.github.io/> <s>antoniii</s> </a> <a href=https://citrux.github.io/>citrux</a> <a href=https://sputnikas.github.io/>sputnikas</a> </span></div><script>let msg=` А спонсор статей в моём блоге -- моя лень -- спонсор статей.`;[`=`.repeat(msg.length+ 1),msg,`=`.repeat(msg.length+ 1)].forEach(a=>console.warn(a))</script>